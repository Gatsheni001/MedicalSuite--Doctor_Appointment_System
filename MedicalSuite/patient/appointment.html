<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Dashboard</title>
  <!-- Bootstrap CSS -->
  <link href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css" rel="stylesheet">
</head>
<body>
<nav class="navbar navbar-expand-lg navbar-light bg-light">
  <a class="navbar-brand" href="#">MedicalSuite</a>
  <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation">
    <span class="navbar-toggler-icon"></span>
  </button>
  <div class="collapse navbar-collapse justify-content-end" id="navbarNav">
    <ul class="navbar-nav ml-auto">
      <li class="nav-item">
        <a class="nav-link" href="/patient/dashboard.html">Dashboard</a>
      </li>
      <li class="nav-item">
        <a class="nav-link" href="/patient/appointment.html">Appointments</a>
      </li>
      <li class="nav-item">
        <a class="nav-link" id="logout-link" href="#">Logout</a>
      </li>
    </ul>
  </div>
</nav>

<!-- Create a table to display the appointments -->
<div class="container mt-5">
  <h2>My Appointments</h2>
  <table class="table">
    <thead>
      <tr>
        <th scope="col">#</th>
        <th scope="col">Doctor</th>
        <th scope="col">Date</th>
        <th scope="col">Time</th>
        <th scope="col">Status</th>
      </tr>
    </thead>
    <tbody id="appointments-table">
      <!-- Appointments will be dynamically added here -->
    </tbody>
  </table>
</div>

<!-- Include Firebase SDK -->
<!-- FILEPATH: /c:/Users/HyperLFN/Documents/GitHub/MedicalSuite--Doctor_Appointment_System/MedicalSuite/firebase.js -->
<script src="https://www.gstatic.com/firebasejs/8.6.1/firebase-app.js"></script>
<script src="https://www.gstatic.com/firebasejs/8.6.1/firebase-auth.js"></script>
<script src="https://www.gstatic.com/firebasejs/8.6.1/firebase-firestore.js"></script>

<!-- Initialize Firebase -->
<script>
  var firebaseConfig = {
    // Your Firebase config here
  };
  firebase.initializeApp(firebaseConfig);

  // Get the current user's appointments from Firestore
  var user = firebase.auth().currentUser;
  var db = firebase.firestore();
  db.collection("appointments").where("patientId", "==", user.uid)
    .get()
    .then((querySnapshot) => {
      querySnapshot.forEach((doc) => {
        // Add each appointment to the table
        var appointment = doc.data();
        var row = "<tr><th scope='row'>" + doc.id + "</th><td>" + appointment.doctorName + "</td><td>" + appointment.date + "</td><td>" + appointment.time + "</td><td>" + appointment.status + "</td></tr>";
        $("#appointments-table").append(row);
      });
    })
    .catch((error) => {
      console.log("Error getting appointments: ", error);
    });
</script>

<!--This code is for the logout -->
<script>
  document.getElementById("logout-link").addEventListener("click", function(event) {
    event.preventDefault(); // Prevent the default link behavior

    // Add debug statements
  console.log("Logout link clicked");

// Send a request to your server to log the user out (if needed)
// Make sure this part is functioning correctly

// Redirect the user to the login page or homepage after logout
window.location.href = "/index.html"; // Homepage

// Add a debug statement to check if the redirection code is executed
console.log("Redirecting to index.html");
});
</script>

<!-- Bootstrap JavaScript -->
<script src="https://code.jquery.com/jquery-3.5.1.slim.min.js" integrity="sha384-DfXdz2htPH0lsSSs5nCTpuj/zy4C+OGpamoFVy38MVBnE+IbbVYUew+OrCXaRkfj" crossorigin="anonymous"></script>
<script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.5.3/dist/umd/popper.min.js"></script>
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js"></script>

</body>
</html>
